{"object":"page","id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e","created_time":"2023-07-17T06:26:00.000Z","last_edited_time":"2023-08-17T06:46:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"cover":{"type":"external","external":{"url":"https://www.notion.so/images/page-cover/woodcuts_8.jpg"}},"icon":null,"parent":{"type":"database_id","database_id":"619787c7-5b60-4798-86c1-47cf746bfbb8"},"archived":false,"properties":{"ÌïòÏúÑ Ìï≠Î™©":{"id":"KuSL","type":"relation","relation":[],"has_more":false},"subclass":{"id":"Q%7DG_","type":"select","select":{"id":"8a8f0473-c4db-4034-8548-c4fefadbd066","name":"RL Theory","color":"purple"}},"class":{"id":"%5BqIJ","type":"select","select":{"id":"b3c6dde5-87ba-4b9d-9c55-a95b883e30d5","name":"RL","color":"red"}},"ÏûëÏÑ±ÏùºÏãú":{"id":"%60W_p","type":"created_time","created_time":"2023-07-17T06:26:00.000Z"},"pdf":{"id":"j%2B)N","type":"files","files":[{"name":"https://wensun.github.io/CS6789_data_fall_2021/Policy_gradient_annotated.pdf","type":"external","external":{"url":"https://wensun.github.io/CS6789_data_fall_2021/Policy_gradient_annotated.pdf"}}]},"ÏÉÅÏúÑ Ìï≠Î™©":{"id":"%7D%5D%3FT","type":"relation","relation":[],"has_more":false},"title":{"id":"title","type":"title","title":[{"type":"text","text":{"content":"13. Policy Gradient and convergence","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"13. Policy Gradient and convergence","href":null}]}},"url":"https://www.notion.so/13-Policy-Gradient-and-convergence-33f8546f03c14abc9e74bacce6e0a87e","public_url":"https://spiritual-latency-306.notion.site/13-Policy-Gradient-and-convergence-33f8546f03c14abc9e74bacce6e0a87e","request_id":"6ddd199f-203f-45cf-abe5-333ff62caf93","blocks":{"object":"list","results":[{"object":"block","id":"968ce226-846f-4bb0-8eae-6e76f60c65ae","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T06:27:00.000Z","last_edited_time":"2023-07-17T06:27:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"callout","callout":{"rich_text":[{"type":"text","text":{"content":"How to compute the gradient of policy?","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"How to compute the gradient of policy?","href":null}],"icon":{"type":"emoji","emoji":"üí°"},"color":"gray_background"}},{"object":"block","id":"d0712bf5-a266-4427-95a6-cd4e6dcecc79","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T06:27:00.000Z","last_edited_time":"2023-07-17T06:27:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"Two formation of Policy Gradient","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Two formation of Policy Gradient","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"a9ededb1-3110-496f-b767-caff03ef7374","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T06:32:00.000Z","last_edited_time":"2023-07-17T06:34:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Examples of Policy Parametrization","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Examples of Policy Parametrization","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"6e0fef68-677c-404c-8d6f-5f01e1b73baf","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T06:34:00.000Z","last_edited_time":"2023-07-17T06:39:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":true,"archived":false,"type":"numbered_list_item","numbered_list_item":{"rich_text":[{"type":"text","text":{"content":"Softmax policy for Tabluar MDPs: ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Softmax policy for Tabluar MDPs: ","href":null},{"type":"equation","equation":{"expression":"\\theta_{s,a}\\in\\R, \\forall s,a \\in S\\times A"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\theta_{s,a}\\in\\R, \\forall s,a \\in S\\times A","href":null}],"color":"default"},"children":{"object":"list","results":[{"object":"block","id":"74743995-393a-45ad-85ef-e39665d53780","parent":{"type":"block_id","block_id":"6e0fef68-677c-404c-8d6f-5f01e1b73baf"},"created_time":"2023-07-17T06:39:00.000Z","last_edited_time":"2023-07-17T07:12:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"\\pi_\\theta(a|s) = \\frac{\\exp(\\theta_{s,a})}{\\sum_{a'}\\exp(\\theta_{s,a'})}"}}],"next_cursor":null,"has_more":false,"type":"block","block":{},"request_id":"151b3cd0-5537-4823-842b-ded04666c56c"}},{"object":"block","id":"cd50a53d-3530-4775-87dc-d7ded28ceca4","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T06:34:00.000Z","last_edited_time":"2023-07-17T07:12:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":true,"archived":false,"type":"numbered_list_item","numbered_list_item":{"rich_text":[{"type":"text","text":{"content":"Softmax linear policy: Feature vector ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Softmax linear policy: Feature vector ","href":null},{"type":"equation","equation":{"expression":"\\phi(s,a)\\in\\R^d"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\phi(s,a)\\in\\R^d","href":null},{"type":"text","text":{"content":" and parameter ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" and parameter ","href":null},{"type":"equation","equation":{"expression":"\\theta\\in\\R^d"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\theta\\in\\R^d","href":null}],"color":"default"},"children":{"object":"list","results":[{"object":"block","id":"d1e7a474-96df-4393-8f17-2852b8221748","parent":{"type":"block_id","block_id":"cd50a53d-3530-4775-87dc-d7ded28ceca4"},"created_time":"2023-07-17T07:12:00.000Z","last_edited_time":"2023-07-17T07:13:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"\\pi_\\theta(a|s) = \\frac{\\exp(\\theta^\\top\\phi(s,a))}{\\sum_{a'}\\exp(\\theta^\\top\\phi(s,a'))}"}}],"next_cursor":null,"has_more":false,"type":"block","block":{},"request_id":"a1dfc5b8-72a9-4275-9324-57fa0b486bf2"}},{"object":"block","id":"0b868f6f-4b81-426e-a364-be1bb5964fc9","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T06:34:00.000Z","last_edited_time":"2023-07-17T07:13:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":true,"archived":false,"type":"numbered_list_item","numbered_list_item":{"rich_text":[{"type":"text","text":{"content":"Neural Policy: Neural lnetwork ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Neural Policy: Neural lnetwork ","href":null},{"type":"equation","equation":{"expression":"f_\\theta:S\\times A\\rightarrow\\R"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"f_\\theta:S\\times A\\rightarrow\\R","href":null}],"color":"default"},"children":{"object":"list","results":[{"object":"block","id":"bb021937-cbef-4480-8073-144766d5ed9f","parent":{"type":"block_id","block_id":"0b868f6f-4b81-426e-a364-be1bb5964fc9"},"created_time":"2023-07-17T07:13:00.000Z","last_edited_time":"2023-07-17T07:14:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"\\pi_\\theta(a|s)=\\frac{\\exp(f_\\theta(s,a))}{\\sum_{a'}\\exp(f_\\theta(s,a'))}"}}],"next_cursor":null,"has_more":false,"type":"block","block":{},"request_id":"d4487780-7bc7-4cef-9489-d3ac1755c01d"}},{"object":"block","id":"216c6fba-38b0-4342-a792-34f7c22b458e","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T07:15:00.000Z","last_edited_time":"2023-07-17T07:15:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Warm up","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Warm up","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"98c6f1f9-a859-4146-bf8d-3396e1839f60","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T07:15:00.000Z","last_edited_time":"2023-07-17T07:17:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"equation","equation":{"expression":"J(\\theta) = \\mathbb{E}_{x\\sim P_\\theta}[f(x)]"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"J(\\theta) = \\mathbb{E}_{x\\sim P_\\theta}[f(x)]","href":null},{"type":"text","text":{"content":", then ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":", then ","href":null},{"type":"equation","equation":{"expression":"\\nabla_\\theta J(\\theta)|_{\\theta=\\theta_0}=\\mathbb{E}_{x\\sim P_{\\theta_0}}\\nabla_\\theta\\ln P_{\\theta_0}(x)f(x)"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\nabla_\\theta J(\\theta)|_{\\theta=\\theta_0}=\\mathbb{E}_{x\\sim P_{\\theta_0}}\\nabla_\\theta\\ln P_{\\theta_0}(x)f(x)","href":null}],"color":"default"}},{"object":"block","id":"629176a2-7c1a-48a1-93e4-cbcc2b8f8ff9","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T07:17:00.000Z","last_edited_time":"2023-07-17T07:17:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Derivation of Policy Gradient: REINFORCE","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Derivation of Policy Gradient: REINFORCE","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"18ccc6ed-c882-4690-92e9-1d58e7e7e6db","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T07:17:00.000Z","last_edited_time":"2023-07-17T07:20:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":true,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Assume: ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Assume: ","href":null},{"type":"equation","equation":{"expression":"\\tau = \\{s_0,a_0,s_1,a_1,...\\}"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\tau = \\{s_0,a_0,s_1,a_1,...\\}","href":null},{"type":"text","text":{"content":", ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":", ","href":null},{"type":"equation","equation":{"expression":"\\rho_\\theta(t) =\\rho(s_0)\\pi_\\theta(a_0|s_0)P(s_1|s_0,a_0)\\pi_\\theta(a_1|s_1)..."},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\rho_\\theta(t) =\\rho(s_0)\\pi_\\theta(a_0|s_0)P(s_1|s_0,a_0)\\pi_\\theta(a_1|s_1)...","href":null},{"type":"text","text":{"content":", ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":", ","href":null},{"type":"equation","equation":{"expression":"J(\\pi_\\theta) = \\mathbb{E}_{\\tau\\sim\\rho_\\theta(\\tau)}\\left[\\sum_{h=0}^\\infty \\gamma^hr(s_h,a_h) \\right]"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"J(\\pi_\\theta) = \\mathbb{E}_{\\tau\\sim\\rho_\\theta(\\tau)}\\left[\\sum_{h=0}^\\infty \\gamma^hr(s_h,a_h) \\right]","href":null}],"color":"default"},"children":{"object":"list","results":[{"object":"block","id":"b0e03497-f81e-460b-8d68-699c92327841","parent":{"type":"block_id","block_id":"18ccc6ed-c882-4690-92e9-1d58e7e7e6db"},"created_time":"2023-07-17T07:20:00.000Z","last_edited_time":"2023-07-17T07:21:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"\\nabla_\\theta J(\\pi_\\theta) = \\mathbb{E}_{\\tau\\sim\\rho_\\theta(\\tau)}\\left[\\left(\\sum_{h=0}^{\\infty}\\nabla_\\theta\\ln\\pi_\\theta(a_h|s_h)\\right)R(\\tau)\\right]"}}],"next_cursor":null,"has_more":false,"type":"block","block":{},"request_id":"f139f824-5db0-4fc0-a7c1-b9c88b99d9f7"}},{"object":"block","id":"d2a966ef-246e-45e3-8b10-f405870d65c4","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T07:21:00.000Z","last_edited_time":"2023-07-17T07:22:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Derivation of Policy Gradient with ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Derivation of Policy Gradient with ","href":null},{"type":"equation","equation":{"expression":"Q^\\pi"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Q^\\pi","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"64f6aaca-c3c1-4f42-be74-c7c049751dbb","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T07:22:00.000Z","last_edited_time":"2023-07-17T10:43:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":true,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Recall definition of value function ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Recall definition of value function ","href":null},{"type":"equation","equation":{"expression":"V^{\\pi_\\theta}(s)"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"V^{\\pi_\\theta}(s)","href":null}],"color":"default"},"children":{"object":"list","results":[{"object":"block","id":"0eef510f-3afa-4337-82f8-c74292da345e","parent":{"type":"block_id","block_id":"64f6aaca-c3c1-4f42-be74-c7c049751dbb"},"created_time":"2023-07-17T10:40:00.000Z","last_edited_time":"2023-07-17T10:42:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"\\begin{aligned}\\nabla_\\theta J(\\pi_\\theta) &= \\nabla_\\theta\\mathbb{E}_{s_0\\sim \\rho}\\left[V^{\\pi_\\theta}(s_0) \\right]\\\\&=\\nabla_\\theta\\mathbb{E}_{s_0\\sim \\rho}\\left[\\nabla_\\theta\\mathbb{E}_{a_0\\sim \\pi_\\theta(s_0)}Q^{\\pi_\\theta}(s_0, a_0) \\right]\\\\&=\\frac 1{1-\\gamma}\\mathbb{E}_{s,a\\sim d^{\\pi_\\theta}}\\nabla_\\theta\\ln\\pi_\\theta(a|s)Q^{\\pi_\\theta}(s,a)\\end{aligned}"}}],"next_cursor":null,"has_more":false,"type":"block","block":{},"request_id":"5d9386a8-e1eb-4d98-b1e4-b46f8849e4e4"}},{"object":"block","id":"abb76b89-b98c-4342-8d16-7306031e4733","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T10:43:00.000Z","last_edited_time":"2023-07-17T10:44:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":true,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Derivation of unbiased stochastic policy gradient: roll in ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Derivation of unbiased stochastic policy gradient: roll in ","href":null},{"type":"equation","equation":{"expression":"\\pi_\\theta"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\pi_\\theta","href":null},{"type":"text","text":{"content":" to generate ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" to generate ","href":null},{"type":"equation","equation":{"expression":"s_h, a_h \\sim \\mathbb{P}_h^{\\pi_\\theta}"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"s_h, a_h \\sim \\mathbb{P}_h^{\\pi_\\theta}","href":null}],"color":"default"},"children":{"object":"list","results":[{"object":"block","id":"683c5a9a-7bac-4afd-a305-e20304356853","parent":{"type":"block_id","block_id":"abb76b89-b98c-4342-8d16-7306031e4733"},"created_time":"2023-07-17T10:43:00.000Z","last_edited_time":"2023-07-17T10:44:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Terminate with probability ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Terminate with probability ","href":null},{"type":"equation","equation":{"expression":"1-\\gamma"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"1-\\gamma","href":null},{"type":"text","text":{"content":", ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":", ","href":null},{"type":"equation","equation":{"expression":"\\widetilde Q^{\\pi_\\theta}(s_h,a_h) = \\sum_{\\tau=h}^{t\\ge h}r_\\tau"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\widetilde Q^{\\pi_\\theta}(s_h,a_h) = \\sum_{\\tau=h}^{t\\ge h}r_\\tau","href":null}],"color":"default"}},{"object":"block","id":"dae2da8d-3780-4894-a92f-b7aea809b56c","parent":{"type":"block_id","block_id":"abb76b89-b98c-4342-8d16-7306031e4733"},"created_time":"2023-07-17T10:44:00.000Z","last_edited_time":"2023-07-17T10:45:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Unbiased estimate ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Unbiased estimate ","href":null},{"type":"equation","equation":{"expression":"\\nabla_\\theta\\ln\\pi_\\theta(a_h|s_h)\\widetilde Q^{\\pi_\\theta}(s_h,a_h)"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\nabla_\\theta\\ln\\pi_\\theta(a_h|s_h)\\widetilde Q^{\\pi_\\theta}(s_h,a_h)","href":null}],"color":"default"}}],"next_cursor":null,"has_more":false,"type":"block","block":{},"request_id":"9d514c27-7fbe-48e0-a638-ad0f1e241ec9"}},{"object":"block","id":"985959aa-4c64-46bc-8350-5809621475a3","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T06:27:00.000Z","last_edited_time":"2023-07-17T10:43:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"Variance Reduction","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Variance Reduction","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"ec6539d1-526b-4015-b7d3-6d233dc76ae8","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T10:45:00.000Z","last_edited_time":"2023-07-17T10:46:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Variance Reduction via Action-Independent Baseline","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Variance Reduction via Action-Independent Baseline","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"a788acdb-a883-4871-8231-109d4cda4f1f","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T10:49:00.000Z","last_edited_time":"2023-07-17T10:50:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"\\nabla_\\theta\\ln\\pi_\\theta(a_h|s_h)\\left(\\widetilde Q^{\\pi_\\theta}(s_h, a_h)-b(s_h) \\right)"}},{"object":"block","id":"40198056-feed-4c07-8740-8308e5c3a0d1","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T10:50:00.000Z","last_edited_time":"2023-07-17T10:51:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"The best baseline that minimizes variance is","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"The best baseline that minimizes variance is","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"0638d372-fab8-4764-b6d3-bbed5f52b0f4","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T10:51:00.000Z","last_edited_time":"2023-07-17T10:51:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"\\min_b\\mathbb{E}\\left[\\left(\\nabla_\\theta\\ln\\pi_\\theta(a_h|s_h)\\left(\\widetilde Q^{\\pi_\\theta}(s_h, a_h)-b(s_h) \\right) \\right)^\\top \\nabla_\\theta\\ln\\pi_\\theta(a_h|s_h)\\left(\\widetilde Q^{\\pi_\\theta}(s_h, a_h)-b(s_h) \\right) \\right]"}},{"object":"block","id":"0a0005f9-ebbe-47d1-be4d-09161ff25401","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T10:51:00.000Z","last_edited_time":"2023-07-17T10:53:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"b(s_h) = \\frac{\\mathbb{E}\\left[ \\nabla_\\theta\\ln\\pi_\\theta(a_h|s_h)^\\top \\nabla_\\theta\\ln\\pi_\\theta(a_h|s_h)  \\left(\\widetilde Q^{\\pi_\\theta}(s_h, a_h)\\right)\\right]}{\\mathbb{E}\\left[\\nabla_\\theta\\ln\\pi_\\theta(a_h|s_h)^\\top \\nabla_\\theta\\ln\\pi_\\theta(a_h|s_h) \\right]}"}},{"object":"block","id":"f300a7b5-695e-4ce6-83a5-839c4eed4157","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T06:27:00.000Z","last_edited_time":"2023-07-17T10:51:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"Convergence of SGD","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Convergence of SGD","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"916e0435-2091-405e-a371-54f1e4367187","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T10:53:00.000Z","last_edited_time":"2023-07-17T12:09:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"equation","equation":{"expression":"\\beta"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\beta","href":null},{"type":"text","text":{"content":"-smooth","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"-smooth","href":null}],"color":"default"}},{"object":"block","id":"879986c4-0de2-40bf-a19c-de6bfed3ade6","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T10:54:00.000Z","last_edited_time":"2023-07-17T10:55:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"\\|\\nabla_\\theta J(\\theta) -\\nabla_\\theta J(\\theta_0)\\|_2\\le\\beta\\|\\theta-\\theta_0\\|_2 \\\\ \\left|J(\\theta)-J(\\theta_0)-\\nabla_\\theta J(\\theta_0)^\\top(\\theta-\\theta_0) \\right|\\le \\frac\\beta2\\|\\theta-\\theta_0\\|_2^2\\forall\\theta,\\theta_0"}},{"object":"block","id":"d80148be-a78e-4595-8f27-f59a00ae24aa","parent":{"type":"page_id","page_id":"33f8546f-03c1-4abc-9e74-bacce6e0a87e"},"created_time":"2023-07-17T10:55:00.000Z","last_edited_time":"2023-07-17T12:09:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":true,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Theorem: if ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Theorem: if ","href":null},{"type":"equation","equation":{"expression":"J(\\theta)"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"J(\\theta)","href":null},{"type":"text","text":{"content":" is ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" is ","href":null},{"type":"equation","equation":{"expression":"\\beta"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\beta","href":null},{"type":"text","text":{"content":"-smooth, and we run SGA: ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"-smooth, and we run SGA: ","href":null},{"type":"equation","equation":{"expression":"\\theta_{t+1} = \\theta_t+\\eta\\widetilde\\nabla_\\theta J(\\theta_t)"},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\\theta_{t+1} = \\theta_t+\\eta\\widetilde\\nabla_\\theta J(\\theta_t)","href":null},{"type":"text","text":{"content":" where","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" where","href":null}],"color":"default"},"children":{"object":"list","results":[{"object":"block","id":"90b333fa-fcbd-45bf-8f79-53f6fa743bb0","parent":{"type":"block_id","block_id":"d80148be-a78e-4595-8f27-f59a00ae24aa"},"created_time":"2023-07-17T12:07:00.000Z","last_edited_time":"2023-07-17T12:08:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"\\mathbb{E}\\left[\\widetilde \\nabla_\\theta J(\\theta_t)\\right] = \\nabla_\\theta J(\\theta_t), \\mathbb{E}\\left[\\left\\| \\nabla_\\theta J(\\theta_t)\\right\\|^2_2\\right]\\le\\sigma^2"}},{"object":"block","id":"99848d18-c5be-43f5-a5f1-852764713a15","parent":{"type":"block_id","block_id":"d80148be-a78e-4595-8f27-f59a00ae24aa"},"created_time":"2023-07-17T12:08:00.000Z","last_edited_time":"2023-07-17T12:08:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"then","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"then","href":null}],"color":"default"}},{"object":"block","id":"ce727e91-193f-4229-b1ac-c0649f1b2c7e","parent":{"type":"block_id","block_id":"d80148be-a78e-4595-8f27-f59a00ae24aa"},"created_time":"2023-07-17T12:08:00.000Z","last_edited_time":"2023-07-17T12:09:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"equation","equation":{"expression":"\\mathbb{E}\\left[\\frac 1T\\sum_t \\| \\nabla_\\theta J(\\theta_t) \\|_2^2 \\right] \\le O\\left(\\sqrt{\\beta\\sigma^2/T} \\right)"}},{"object":"block","id":"fe56b99a-cb5d-4a27-9ec8-c6357cfa16bc","parent":{"type":"block_id","block_id":"d80148be-a78e-4595-8f27-f59a00ae24aa"},"created_time":"2023-07-17T12:09:00.000Z","last_edited_time":"2023-07-17T12:09:00.000Z","created_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"last_edited_by":{"object":"user","id":"22486098-d4a4-4dea-aeb1-06817ec8b304"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[],"color":"default"}}],"next_cursor":null,"has_more":false,"type":"block","block":{},"request_id":"870355d7-7312-4016-94a1-eaabe2311b5d"}}],"next_cursor":null,"has_more":false,"type":"block","block":{},"request_id":"ced63bfa-2e87-48f6-ba65-9813a74ff805"}}